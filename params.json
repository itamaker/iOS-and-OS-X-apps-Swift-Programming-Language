{"name":"Ios-and-os-x-apps-swift-programming-language","tagline":"The Swift Programming Language for iOS Developer","body":"The-Swift-Programming-Language\r\n==============================\r\n\r\nThis project spawns different formats of PDF, MOBI and monopage Html of [The Swift Programming Language][1] for iOS Developer published on WWDC 2014 of [Appel Inc.][2], 06-02-2014\r\n\r\nThe project page at [myproject](http://muxuezi.github.io/iOS-and-OS-X-apps-Swift-Programming-Language/ \"swiftpl\")\r\n\r\nThe blog page at [myblog](http://muxuezi.github.io/posts/the-swift-programming-language.html \"swift\")\r\n\r\npython code for [Web crawler](https://gist.github.com/muxuezi/429c80732a8cf834caef \"gist\")\r\n```python\r\n# -*- coding: utf-8 -*-\r\n#-------------------------------------------------------------------------\r\n# Name:        The-Swift-Programming-Language\r\n# Purpose:     Web crawler of Swift, Python is slow-------\r\n#\r\n# Author:      muxuezi@gmail.com\r\n#\r\n# Created:     03/06/2014\r\n# Copyright:   (c) muxuezi 2014\r\n# Licence:     <All licence>\r\n#-------------------------------------------------------------------------\r\nfrom bs4 import BeautifulSoup\r\nfrom urllib2 import urlopen\r\nimport re\r\nimport time\r\nimport thread\r\n\r\n\r\nallPageCnt = {}\r\nmutex = thread.allocate_lock()\r\nexitmutexes = [thread.allocate_lock() for i in range(35)]\r\nbaseUrl = 'https://developer.apple.com/library/prerelease/ios/documentation \\\r\n                    /Swift/Conceptual/Swift_Programming_Language/'\r\n\r\n\r\ndef cleanpage(url):\r\n    soup = BeautifulSoup(urlopen(url))\r\n    art = soup.find('article', class_=\"chapter\")\r\n    styleChange = [('<h2', '<h1'), ('</h2>', '</h1>'),\r\n                   ('<h3', '<h2'), ('</h3>', '</h2>')]\r\n    artHtml = re.sub(re.compile(\r\n        '<section\\sclass=\"\"\\sid=\"next_previous\">.+?</section>', re.DOTALL), '', str(art))\r\n    for x, y in styleChange:\r\n        artHtml = re.sub(re.compile(x), y, artHtml)\r\n    return artHtml\r\n\r\n\r\ndef getpage(idx, unit, mutex):\r\n    # web crawler\r\n    with mutex:\r\n        url, name = unit\r\n        url = baseUrl + url\r\n        page = cleanpage(url)\r\n        allPageCnt[idx + 1] = page\r\n        print idx + 1, name\r\n    exitmutexes[idx].acquire()\r\n\r\n\r\ndef main():\r\n    # read all links\r\n    soup = BeautifulSoup(urlopen(baseUrl))\r\n    tt = soup.find('nav', class_=\"book-parts hideInXcode\")\r\n    allLink = map(lambda x: (x.get('href'), x.text), tt.findAll('a'))\r\n    for idx, unit in enumerate(allLink):\r\n        thread.start_new_thread(getpage, (idx, unit, mutex))\r\n    while True:\r\n        if all(mutex.locked() for mutex in exitmutexes):\r\n            with open('swift.html', 'wb') as f:\r\n                for k, apage in sorted(allPageCnt.items()):\r\n                    f.write(apage)\r\n            print 'All done'\r\n            break\r\n        else:\r\n            time.sleep(0.01)\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n./Art include css and pictures\r\n\r\nLast Step: Use html2text.py convert to markdown\r\n\r\n`html2text.py swift.html --ignore-links --ignore-images > swift.md`\r\n\r\n[1]: https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/ \"The Swift Programming Language\"\r\n[2]: https://www.apple.com \"Appel Inc.\"\r\n\r\n### Authors and Contributors\r\nIn 2014, Muxuezi Tao (@muxuezi), Carrie Chen (@carrie) founded GitHub.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}